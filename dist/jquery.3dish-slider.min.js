/*! 3dish  Slider - v0.1.0 - 2012-05-02
* https://github.com/SimonBoudrias/jquery.3dish-slider
* Copyright (c) 2012 Simon Boudrias; Licensed MIT, GPL */
(function(a){"use strict";var b=function(a,b){this.init("ThreeDish",a,b)};b.prototype={constructor:b,init:function(b,c,d){this.type=b,this.$element=a(c),this.opt=this.getOptions(d),this.styles=[],this.zIndex=[],this.animating=!1,this.$hiddenSlides=[],this.$visibleSlides=[];var e=this,f=this.$element.find(this.opt.slideClass),g=0,h=0,i=0;for(;i<this.opt.slideNbr+1;i+=1){var j=1-this.opt.zStep*i;this.styles[i]={display:"block",opacity:1,transform:"scale("+j+")"},this.styles[i][this.opt.xOrigin]=h+this.opt.xStep*i+"px",this.styles[i][this.opt.yOrigin]=g+this.opt.yStep*i+"px",this.zIndex[i]={zIndex:this.opt.slideZIndex-i}}this.hiddenStyle=this.styles.pop(),this.hiddenStyle=a.extend(this.hiddenStyle,{opacity:0,transform:"scale(0)"},this.zIndex.pop()),this.leavingStyle={zIndex:this.opt.slideZIndex+1,transform:"scale("+(1+this.opt.zStep)+")",opacity:0},this.leavingStyle[this.opt.xOrigin]="-"+e.opt.xStep+"px",this.leavingStyle[this.opt.yOrigin]="-"+e.opt.yStep+"px",f.slice(this.opt.slideNbr).each(function(){e.$hiddenSlides.push(a(this))}),f.slice(0,this.opt.slideNbr).each(function(){e.$visibleSlides.push(a(this))}),a.each(this.$visibleSlides,function(b,c){c.css(a.extend(e.styles[b],e.zIndex[b]))}),a.each(this.$hiddenSlides,function(a,b){b.css(e.hiddenStyle)})},getOptions:function(b){return b=a.extend({},a.fn[this.type].defaults,b,this.$element.data()),b},next:function(){if(this.animating)return;this.animating=!0;var b=this,c=[],d=this.$hiddenSlides.shift();this.$visibleSlides.push(d),this.$disappearingSlide=this.$visibleSlides.shift(),this.$hiddenSlides.push(this.$disappearingSlide),a.each(this.$visibleSlides,function(d,e){var f=new a.Deferred;c.push(f.promise()),e.animate(b.styles[d],{duration:b.opt.animationSpeed,complete:function(){f.resolve()}})}),this.$disappearingSlide.animate(this.leavingStyle,{duration:b.opt.animationSpeed,complete:function(){a(this).css(b.hiddenStyle)}}),a.when.apply(this,c).done(function(){b.animating=!1,a.each(b.$visibleSlides,function(a,c){c.css(b.zIndex[a])}),a.isFunction(b.opt.moveCallback)&&b.opt.moveCallback(),typeof b.opt.moveEvent=="String"&&(a(document).trigger(b.opt.moveEvent),a(document).trigger(b.opt.moveEvent+":next"))})},prev:function(){if(this.animating)return;this.animating=!0;var b=this,c=[],d=this.$hiddenSlides.pop();this.$visibleSlides.unshift(d),d.css(this.leavingStyle),this.$disappearingSlide=this.$visibleSlides.pop(),this.$hiddenSlides.unshift(this.$disappearingSlide),a.each(this.$visibleSlides,function(d,e){var f=new a.Deferred;c.push(f.promise()),e.animate(b.styles[d],{duration:b.opt.animationSpeed,complete:function(){f.resolve()}})}),this.$disappearingSlide.animate(this.hiddenStyle,{duration:b.opt.animationSpeed}),a.when.apply(this,c).done(function(){b.animating=!1,a.each(b.$visibleSlides,function(a,c){c.css(b.zIndex[a])}),a.isFunction(b.opt.moveCallback)&&b.opt.moveCallback(),typeof b.opt.moveEvent=="String"&&(a(document).trigger(b.opt.moveEvent),a(document).trigger(b.opt.moveEvent+":prev"))})}},a.fn.ThreeDish=function(c){return this.each(function(){var d=a(this),e=d.data("ThreeDish"),f=typeof c=="object"&&c;e||d.data("ThreeDish",e=new b(this,f)),typeof c=="string"&&e[c]()})},a.fn.ThreeDish.Constructor=b,a.fn.ThreeDish.defaults={animationSpeed:500,slideClass:".slide",slideSize:{width:"300px",height:"100px"},slideZIndex:1e4,slideNbr:4,xOrigin:"left",yOrigin:"bottom",xStep:30,yStep:20,zStep:.2,moveCallback:!1,moveEvent:"ThreeDish:move"}})(window.jQuery)